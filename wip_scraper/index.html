<html>
<body>

<h1> bid scraper</h1>
<p> This is a tool I use to pull anonymised bid data. It creates a CSV with three columns: Employer Name, Successful Bid, Bid Rank. </p>
<p> to use it, I drag this link onto my bookmarks bar: </p>
<a href='javascript:()=>{var load_all = () => {window.location.assign(`${window.location.href.split("=")[0]}=2000`)};var warning = () => {d=document;p=d.createElement("div");p.innerText="loading everything onto one page. hit the button again when this warning goes away.";p.setAttribute("style","width: 100vw; text-align: center; background: #DDA; font-size: 30px; height: 50px; line-height: 50px; top: 0; position: fixed; z-index: 10000;");d.body.prepend(p);};var gen_output = () => {return "employer,got_interview,bid_rank\n" + Array.prototype.slice.call(document.getElementsByClassName("list-row")).map((e) => {var t=[];for (var f of ["Employer", "Interview Dates", "Bidding"])t.push(`"${e.querySelector(`[data-th="${f}"]`).innerText.replace("\n", "")}"`);return `${t[0]},${t[1].indexOf("Scheduled")>=0},${t[2]}`}).join("\n")};var output=window.location.href.endsWith("2000")?gen_output():warning()||load_all();if (output) {var a=document.createElement("a");var f=new Blob([output],{type:"text/csv"});a.href=URL.createObjectURL(f); a.download=name;d=document;p=d.createElement("div");p.prepend(a);a.innerText="click to download anonymized bid data";p.setAttribute("style","width: 100vw; text-align: center; background: #CFC; font-size: 30px; height: 50px; line-height: 50px; top: 0; position: fixed; z-index: 10000;");a.setAttribute("style", "font-size:30px");d.body.prepend(p);}}();'> Scan CSM </a>
<p> (1) load the OCI bid page and change the number of rows per page to any value other than ten. (2) wait for the page to reload. (3) hit the button. (4) wait for the processing message to disappear (5) hit the button again (6) click the "download CSV" link at the top of the page. <p>
</body>
</html>
